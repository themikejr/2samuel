---
import Layout from '../layouts/Layout.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';
import { getCollection } from 'astro:content';
import FormattedDate from '../components/FormattedDate.astro';

// Get the most recent blog post
const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
const latestPost = posts[0];
---

<Layout title={SITE_TITLE}>
	<p class="subtitle">{SITE_DESCRIPTION}</p>
	
	<h2>Welcome to Our Study</h2>
	<p>
		Welcome to our 2 Samuel study group! This site contains weekly study materials, 
		resources, and discussions as we journey through the second book of Samuel together.
	</p>
	
	<p>
		Each week, you'll find new study materials including background information, 
		key themes, discussion questions, and additional resources to deepen your 
		understanding of this pivotal book in Israel's history.
	</p>
	
	<h2>Latest Study</h2>
	{latestPost && (
		<article class="latest-post">
			<h3 class="post-title" style={`view-transition-name: post-title-${latestPost.id}`}>
				<a href={`/blog/${latestPost.id}`}>{latestPost.data.title}</a>
			</h3>
			<div class="post-meta">
				<FormattedDate date={latestPost.data.pubDate} />
			</div>
			<p class="post-description">{latestPost.data.description}</p>
			<a href={`/blog/${latestPost.id}`} class="read-more">Read the full study â†’</a>
		</article>
	)}
	<p>
		Browse all our <a href="/blog">weekly studies</a> as we follow David's 
		journey from shepherd king to established monarch.
	</p>
	
</Layout>

<style>
	.latest-post {
		background: var(--color-bg);
		border: 1px solid var(--color-text-light);
		border-radius: 8px;
		padding: 1.5rem;
		margin: 1.5rem 0;
	}

	.post-title {
		margin: 0 0 0.5rem 0;
		font-family: var(--font-display);
		font-size: 1.5rem;
		font-weight: 600;
		line-height: 1.3;
		letter-spacing: -0.01em;
	}

	.post-title a {
		color: var(--color-text);
		text-decoration: none;
	}

	.post-title a:hover {
		color: var(--color-accent);
		text-decoration: underline;
	}

	.post-meta {
		color: var(--color-text-light);
		font-size: 0.9rem;
		margin-bottom: 1rem;
	}

	.post-description {
		margin-bottom: 1rem;
		line-height: 1.5;
	}

	.read-more {
		color: var(--color-accent);
		text-decoration: none;
		font-weight: 500;
		font-size: 0.95rem;
	}

	.read-more:hover {
		text-decoration: underline;
	}
</style>
